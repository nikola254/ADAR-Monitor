# Security Monitor - Утилита мониторинга защищённости системных приложений

Утилита для обнаружения отладки и реверс-инжиниринга в Linux системах.

## Возможности

- **Детекция отладчиков**: Обнаружение присоединённых отладчиков через ptrace, /proc/self/status и timing attacks
- **Мониторинг процессов**: Отслеживание подозрительных процессов (gdb, strace, radare2, и др.)
- **Системный мониторинг**: Контроль файловой системы, сетевой активности и системных ресурсов
- **GUI интерфейс**: Удобный графический интерфейс для мониторинга в реальном времени
- **Консольный режим**: Возможность запуска без GUI

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository_url>
cd kali_utils
```

2. Создайте виртуальное окружение:
```bash
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate     # Windows
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

### Запуск с GUI (по умолчанию)
```bash
python3 main.py --gui
```

### Запуск в консольном режиме
```bash
python3 main.py --console
```

### Просмотр справки
```bash
python3 main.py --help
```

## Структура проекта

```
kali_utils/
├── main.py                          # Главный файл приложения
├── requirements.txt                 # Зависимости Python
├── README.md                       # Документация
├── venv/                          # Виртуальное окружение
└── src/                           # Исходный код
    ├── detectors/                 # Модули детекции
    │   ├── debugger_detector.py   # Детектор отладчиков
    │   └── process_monitor.py     # Мониторинг процессов
    ├── monitoring/                # Системный мониторинг
    │   └── system_monitor.py      # Мониторинг системы
    └── gui/                       # Графический интерфейс
        └── monitor_window.py      # Главное окно GUI
```

## Детекторы

### Детектор отладчиков (DebuggerDetector)
- **ptrace проверка**: Попытка присоединения к самому себе
- **Проверка /proc/self/status**: Анализ поля TracerPid
- **Timing attack**: Измерение времени выполнения
- **Проверка родительского процесса**: Анализ имени родительского процесса

### Мониторинг процессов (ProcessMonitor)
Отслеживает запуск подозрительных процессов:
- Отладчики: gdb, lldb, strace, ltrace
- Дизассемблеры: radare2, ghidra, ida, x64dbg
- Анализаторы: valgrind, objdump, readelf
- Инструменты взлома: metasploit, burpsuite, nmap

### Системный мониторинг (SystemMonitor)
- Мониторинг критичных файлов (/etc/passwd, /etc/shadow)
- Отслеживание сетевой активности и подозрительных портов
- Контроль использования системных ресурсов
- Проверка загруженных модулей ядра
- Анализ переменных окружения

## GUI Интерфейс

Графический интерфейс включает:
- **Панель статуса**: Текущее состояние мониторинга
- **Вкладка "Алерты"**: Журнал обнаруженных угроз
- **Вкладка "Система"**: Информация о системных ресурсах
- **Вкладка "Процессы"**: Список подозрительных процессов
- **Кнопки управления**: Пауза, очистка логов, сохранение отчёта

## Безопасность

⚠️ **Внимание**: Данная утилита предназначена для образовательных целей и тестирования безопасности собственных систем. Не используйте её для несанкционированного доступа к чужим системам.

## Требования

- Python 3.6+
- Linux операционная система (рекомендуется)
- Права администратора для некоторых функций мониторинга

## Лицензия

Данный проект создан в образовательных целях для курсовой работы.

## Разработка

Для разработки и расширения функциональности:

1. Добавьте новые детекторы в `src/detectors/`
2. Расширьте системный мониторинг в `src/monitoring/`
3. Улучшите GUI в `src/gui/`
4. Обновите документацию

## Известные ограничения

- Некоторые методы детекции могут давать ложные срабатывания
- Требуются права root для полного функционала
- GUI требует установленного tkinter
- Оптимизировано для Linux систем